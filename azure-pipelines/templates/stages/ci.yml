jobs:
  - job: BuildAndAnalyze
    displayName: " Build + An√°lisis Sonar"
    pool:
      vmImage: 'ubuntu-latest'

    variables:
      IMAGE_NAME: 'api-rest-springboot'
      DOCKERHUB_REPO: 'jessi93/api-rest-springboot'

    steps:
      - task: JavaToolInstaller@1
        inputs:
          versionSpec: '17'
          jdkArchitectureOption: 'x64' 
          jdkSourceOption: 'PreInstalled'

      # - task: SonarQubePrepare@7
      #   inputs:
      #     SonarQube: 'sonarq_Servcice'
      #     scannerMode: 'other'

      - script: |
          chmod +x ./gradlew
          ./gradlew clean build test
          cp build/libs/*.jar app.jar
        displayName: ' Compilar y testear'

      # - task: SonarQubeAnalyze@7
      #   inputs:
      #     jdkversion: 'JAVA_HOME_17_X64'

     
      # - task: SonarQubePublish@7
      #   inputs:
      #     pollingTimeoutSec: '300'

